{"version":3,"sources":["../../src/routes/login.js"],"names":["router","post","req","res","body","username","password","context","models","User","findByLogin","user","comparePassword","secret","process","env","SECRET_KEY","token","jwt","sign","status","json","message"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;AAEA;AACA;AACA;AACA;AAEA,IAAMA,MAAM,GAAG,sBAAf;AAEAA,MAAM,CAACC,IAAP,CAAY,GAAZ;AAAA,qEAAiB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,wBACcD,GAAG,CAACE,IADlB,EACTC,QADS,aACTA,QADS,EACCC,QADD,aACCA,QADD;AAAA;AAAA,mBAEIJ,GAAG,CAACK,OAAJ,CAAYC,MAAZ,CAAmBC,IAAnB,CAAwBC,WAAxB,CAAoCL,QAApC,CAFJ;;AAAA;AAETM,YAAAA,IAFS;;AAAA,iBAGXA,IAHW;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAIHA,IAAI,CAACC,eAAL,CAAqBN,QAArB,CAJG;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKX;AACA;AACA;AACMO,YAAAA,MARK,GAQIC,OAAO,CAACC,GAAR,CAAYC,UARhB;AASLC,YAAAA,KATK,GASGC,yBAAIC,IAAJ,CAAS;AAAEd,cAAAA,QAAQ,EAARA;AAAF,aAAT,EAAuBQ,MAAvB,CATH;AAAA,6CAUJV,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,cAAAA,OAAO,EAAE,eADiB;AAE1BL,cAAAA,KAAK,EAALA;AAF0B,aAArB,CAVI;;AAAA;AAAA,6CAgBRd,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAArB,CAhBQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAjB;;AAAA;AAAA;AAAA;AAAA;eAmBetB,M","sourcesContent":["import { Router } from 'express';\nimport jwt from 'jsonwebtoken';\n\n// //passport stuff\n// const passport = require(\"passport\");\n// const jwtStrategry  = require(\"./strategies/jwt\")\n// passport.use(jwtStrategry);\n\nconst router = Router();\n\nrouter.post('/', async (req, res) => {\n  let { username, password } = req.body;\n  const user = await req.context.models.User.findByLogin(username);\n  if (user) {\n    if (await user.comparePassword(password)) {\n      //db calls later\n      //   opts = {};\n      //   opts.expiresIn = 120;\n      const secret = process.env.SECRET_KEY;\n      const token = jwt.sign({ username }, secret);\n      return res.status(200).json({\n        message: 'Authenticated',\n        token,\n      });\n    }\n  }\n  return res.status(401).json({ message: 'Auth Failed' });\n});\n\nexport default router;\n"],"file":"login.js"}