{"version":3,"sources":["../../src/routes/comment.js"],"names":["router","get","req","res","context","models","Comment","find","comments","send","post","params","postId","comment","text","body","user","push","id","create","error","next","BadRequestError","commentPost","findById","commentId","remove"],"mappings":";;;;;;;AAAA;;AACA;;;;;;AAEA,IAAMA,MAAM,GAAG,sBAAf;AAEAA,MAAM,CAACC,GAAP,CAAW,GAAX;AAAA,qEAAgB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACSD,GAAG,CAACE,OAAJ,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2BC,IAA3B,EADT;;AAAA;AACRC,YAAAA,QADQ;AAAA,6CAEPL,GAAG,CAACM,IAAJ,CAASD,QAAT,CAFO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhB;;AAAA;AAAA;AAAA;AAAA;AAKAR,MAAM,CAACC,GAAP,CAAW,UAAX;AAAA,sEAAuB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACED,GAAG,CAACE,OAAJ,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2BC,IAA3B,CAAgC;AACrDG,cAAAA,IAAI,EAAER,GAAG,CAACS,MAAJ,CAAWC;AADoC,aAAhC,CADF;;AAAA;AACfJ,YAAAA,QADe;AAAA,8CAIdL,GAAG,CAACM,IAAJ,CAASD,QAAT,CAJc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAvB;;AAAA;AAAA;AAAA;AAAA;AAOAR,MAAM,CAACU,IAAP,CAAY,UAAZ;AAAA,sEAAwB,kBAAOR,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAChBU,YAAAA,OADgB,GACN;AACdC,cAAAA,IAAI,EAAEZ,GAAG,CAACa,IAAJ,CAASD,IADD;AAEdJ,cAAAA,IAAI,EAAER,GAAG,CAACS,MAAJ,CAAWC;AAFH,aADM;;AAMtB,gBAAIV,GAAG,CAACc,IAAR,EAAc;AACZH,cAAAA,OAAO,CAACI,IAAR,CAAa;AAAED,gBAAAA,IAAI,EAAEd,GAAG,CAACc,IAAJ,CAASE;AAAjB,eAAb;AACD;;AARqB;AAAA,mBASIhB,GAAG,CAACE,OAAJ,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2Ba,MAA3B,CACxBN,OADwB,WAElB,UAACO,KAAD;AAAA,qBAAWC,IAAI,CAAC,IAAIC,uBAAJ,EAAD,CAAf;AAAA,aAFkB,CATJ;;AAAA;AAShBC,YAAAA,WATgB;AAAA,8CAafpB,GAAG,CAACM,IAAJ,CAASc,WAAT,CAbe;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAxB;;AAAA;AAAA;AAAA;AAAA;AAgBAvB,MAAM,UAAN,CAAc,aAAd;AAAA,sEAA6B,kBAAOE,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACLD,GAAG,CAACE,OAAJ,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2BkB,QAA3B,CACpBtB,GAAG,CAACS,MAAJ,CAAWc,SADS,WAEd,UAACL,KAAD;AAAA,qBAAWC,IAAI,CAAC,IAAIC,uBAAJ,EAAD,CAAf;AAAA,aAFc,CADK;;AAAA;AACrBT,YAAAA,OADqB;;AAAA,iBAKvBA,OALuB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAMnBA,OAAO,CAACa,MAAR,EANmB;;AAAA;AAAA,8CASpBvB,GAAG,CAACM,IAAJ,CAASI,OAAT,CAToB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA7B;;AAAA;AAAA;AAAA;AAAA;eAYeb,M,EAEf;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import { Router } from 'express';\nimport { BadRequestError } from '../utils/errors';\n\nconst router = Router();\n\nrouter.get('/', async (req, res) => {\n  const comments = await req.context.models.Comment.find();\n  return res.send(comments);\n});\n\nrouter.get('/:postId', async (req, res) => {\n  const comments = await req.context.models.Comment.find({\n    post: req.params.postId,\n  });\n  return res.send(comments);\n});\n\nrouter.post('/:postId', async (req, res) => {\n  const comment = {\n    text: req.body.text,\n    post: req.params.postId,\n  };\n\n  if (req.user) {\n    comment.push({ user: req.user.id });\n  }\n  const commentPost = await req.context.models.Comment.create(\n    comment,\n  ).catch((error) => next(new BadRequestError()));\n\n  return res.send(commentPost);\n});\n\nrouter.delete('/:commentId', async (req, res) => {\n  const comment = await req.context.models.Comment.findById(\n    req.params.commentId,\n  ).catch((error) => next(new BadRequestError()));\n\n  if (comment) {\n    await comment.remove();\n  }\n\n  return res.send(comment);\n});\n\nexport default router;\n\n//curl http://localhost:3000/comments\n//curl http://localhost:3000/comments/5f08fd7993f784265779f6ca\n//curl -X POST -H \"Content-Type:application/json\" http://localhost:3000/comments/5f08fd7993f784265779f6ca/ -d '{\"text\":\"please work\"}'\n//curl http://localhost:3000/comments/5f08fd7993f784265779f6ca\n//curl -X DELETE http://localhost:3000/comments/<>\n//curl http://localhost:3000/comments/5f08fd7993f784265779f6ca\n"],"file":"comment.js"}