{"version":3,"sources":["../../src/routes/comment.js"],"names":["router","get","req","res","context","models","Comment","find","comments","send","post","params","postId","create","text","body","user","id","error","next","BadRequestError","comment","findById","commentId","remove"],"mappings":";;;;;;;AAAA;;AACA;;;;;;AAEA,IAAMA,MAAM,GAAG,sBAAf;AAEAA,MAAM,CAACC,GAAP,CAAW,GAAX;AAAA,qEAAgB,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACSD,GAAG,CAACE,OAAJ,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2BC,IAA3B,EADT;;AAAA;AACRC,YAAAA,QADQ;AAAA,6CAEPL,GAAG,CAACM,IAAJ,CAASD,QAAT,CAFO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAhB;;AAAA;AAAA;AAAA;AAAA;AAKAR,MAAM,CAACC,GAAP,CAAW,UAAX;AAAA,sEAAuB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACED,GAAG,CAACE,OAAJ,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2BC,IAA3B,CAAgC;AACrDG,cAAAA,IAAI,EAAER,GAAG,CAACS,MAAJ,CAAWC;AADoC,aAAhC,CADF;;AAAA;AACfJ,YAAAA,QADe;AAAA,8CAIdL,GAAG,CAACM,IAAJ,CAASD,QAAT,CAJc;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAvB;;AAAA;AAAA;AAAA;AAAA;AAOAR,MAAM,CAACU,IAAP,CAAY,UAAZ;AAAA,sEAAwB,kBAAOR,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACAD,GAAG,CAACE,OAAJ,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2BO,MAA3B,CAAkC;AACtDC,cAAAA,IAAI,EAAEZ,GAAG,CAACa,IAAJ,CAASD,IADuC;AAEtDE,cAAAA,IAAI,EAAEd,GAAG,CAACc,IAAJ,CAASC,EAFuC;AAGtDP,cAAAA,IAAI,EAAER,GAAG,CAACS,MAAJ,CAAWC;AAHqC,aAAlC,WAIb,UAACM,KAAD;AAAA,qBAAWC,IAAI,CAAC,IAAIC,uBAAJ,EAAD,CAAf;AAAA,aAJa,CADA;;AAAA;AAChBC,YAAAA,OADgB;AAAA,8CAOflB,GAAG,CAACM,IAAJ,CAASY,OAAT,CAPe;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAxB;;AAAA;AAAA;AAAA;AAAA;AAUArB,MAAM,UAAN,CAAc,aAAd;AAAA,sEAA6B,kBAAOE,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACLD,GAAG,CAACE,OAAJ,CAAYC,MAAZ,CAAmBC,OAAnB,CAA2BgB,QAA3B,CACpBpB,GAAG,CAACS,MAAJ,CAAWY,SADS,WAEd,UAACL,KAAD;AAAA,qBAAWC,IAAI,CAAC,IAAIC,uBAAJ,EAAD,CAAf;AAAA,aAFc,CADK;;AAAA;AACrBC,YAAAA,OADqB;;AAAA,iBAKvBA,OALuB;AAAA;AAAA;AAAA;;AAAA;AAAA,mBAMnBA,OAAO,CAACG,MAAR,EANmB;;AAAA;AAAA,8CASpBrB,GAAG,CAACM,IAAJ,CAASY,OAAT,CAToB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA7B;;AAAA;AAAA;AAAA;AAAA;eAYerB,M,EAEf;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import { Router } from 'express';\nimport { BadRequestError } from '../utils/errors';\n\nconst router = Router();\n\nrouter.get('/', async (req, res) => {\n  const comments = await req.context.models.Comment.find();\n  return res.send(comments);\n});\n\nrouter.get('/:postId', async (req, res) => {\n  const comments = await req.context.models.Comment.find({\n    post: req.params.postId,\n  });\n  return res.send(comments);\n});\n\nrouter.post('/:postId', async (req, res) => {\n  const comment = await req.context.models.Comment.create({\n    text: req.body.text,\n    user: req.user.id,\n    post: req.params.postId,\n  }).catch((error) => next(new BadRequestError()));\n\n  return res.send(comment);\n});\n\nrouter.delete('/:commentId', async (req, res) => {\n  const comment = await req.context.models.Comment.findById(\n    req.params.commentId,\n  ).catch((error) => next(new BadRequestError()));\n\n  if (comment) {\n    await comment.remove();\n  }\n\n  return res.send(comment);\n});\n\nexport default router;\n\n//curl http://localhost:3000/comments\n//curl http://localhost:3000/comments/5f08fd7993f784265779f6ca\n//curl -X POST -H \"Content-Type:application/json\" http://localhost:3000/comments/5f08fd7993f784265779f6ca/ -d '{\"text\":\"please work\"}'\n//curl http://localhost:3000/comments/5f08fd7993f784265779f6ca\n//curl -X DELETE http://localhost:3000/comments/<>\n//curl http://localhost:3000/comments/5f08fd7993f784265779f6ca\n"],"file":"comment.js"}